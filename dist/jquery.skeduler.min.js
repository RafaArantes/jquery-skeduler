/**
 * jquery-skeduler - This is jQuery plugin which provider you simple scheduler with some items on OX and 24-hours timeline on OY.
 * @date Fri Jun 30 2017 00:55:48 GMT+1000 (+10)
 * @version v0.1.0-beta.0
 * @link 
 * @license ISC
 */
!function e(t,s,n){function i(o,a){if(!s[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(r)return r(o,!0);var d=new Error("Cannot find module '"+o+"'");throw d.code="MODULE_NOT_FOUND",d}var u=s[o]={exports:{}};t[o][0].call(u.exports,function(e){var s=t[o][1][e];return i(s?s:e)},u,u.exports,e,t,s,n)}return s[o].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,s){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("./skeduler"),r=n(i);$.fn.skeduler=function(e){return this.each(function(){var t=$(this);new r["default"](t,e)})},$.skeduler=r["default"]},{"./skeduler":4}],2:[function(e,t,s){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(s,"__esModule",{value:!0});var i=e("./skeduler"),r=n(i),o=e("./adapter");n(o);s["default"]=r["default"],t.exports=s["default"]},{"./adapter":1,"./skeduler":4}],3:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var n={headers:null,tasks:[],cardTemplate:"<div>${id}</div>",onClick:function(e,t){},containerCssClass:"skeduler-container",headerContainerCssClass:"skeduler-headers",schedulerContainerCssClass:"skeduler-main",taskPlaceholderCssClass:"skeduler-task-placeholder",workingIntervalPlaceholderCssClass:"skeduler-interval-placeholder",cellCssClass:"skeduler-cell",resizableHandlerCssClass:"resizable-handler",resizableSliderCssClass:"resizable-slider",lineHeight:30,borderWidth:1,columnWidth:200,minColumnWidth:100,rowsPerHour:2,columnResizeEnabled:!0,debug:!0,itemsOptions:{enabled:!1}};s.defaultSettings=n},{}],4:[function(e,t,s){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(s,"__esModule",{value:!0});var i=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),r=e("./settings"),o=function(){function e(t,s){n(this,e),this.settings=$.extend(r.defaultSettings,s),this.$container=t,this.$ownerDocument=$(t[0].ownerDocument),this.$headerContainer=null,this.$scheduleEl=null,this.operation=null,this.settings.debug&&console.time("skeduler"),this.populate(t,s),this.settings.itemsOptions.enabled&&this.populateSkedulerItems(this.settings.itemsOptions),this.settings.debug&&console.timeEnd("skeduler")}return i(e,[{key:"populate",value:function(){var e=this;this.$container.empty(),this.$container.addClass(this.settings.containerCssClass);var t=this.settings.headers?this.settings.headers:this.settings.data.map(this.settings.getHeader),s=$("<div></div>");this.$headerContainer=s.clone().addClass(this.settings.headerContainerCssClass),console.log("this.$headerContainer",this.$headerContainer),t.forEach(function(t){s.clone().text(t).appendTo(e.$headerContainer)},this),this.$container.append(this.$headerContainer),this.$scheduleEl=s.clone().addClass(this.settings.schedulerContainerCssClass);for(var n=s.clone().addClass(this.settings.schedulerContainerCssClass+"-timeline"),i=s.clone().addClass(this.settings.schedulerContainerCssClass+"-body"),r=s.clone(),o=0;o<24;o++)for(var a=0;a<this.settings.rowsPerHour;a++){var l=s.clone().height(this.settings.lineHeight).addClass(a==this.settings.rowsPerHour-1?"last":"");0==a&&(l=l.css("line-height",this.settings.lineHeight+"px").text(0==a?this.toTimeString(o):"")),l.appendTo(n),s.clone().addClass(this.settings.cellCssClass).height(this.settings.lineHeight).addClass(a==this.settings.rowsPerHour-1?"last":"").appendTo(r)}for(var a=0;a<t.length;a++){var d=r.clone(),u=s.clone().addClass(this.settings.taskPlaceholderCssClass);this.appendTasks(u,this.settings.tasks.filter(function(e){return e.column==a}));var h=s.clone().addClass(this.settings.workingIntervalPlaceholderCssClass),c=this.settings.data.find(function(e){return e.id===a+1}).workingTimeIntervals;this.appendAvailableInterval(h,c),d.prepend(u),d.prepend(h),d.appendTo(i),this.updateColumnWidth(a,this.settings.columnWidth)}this.$scheduleEl.append(n),this.$scheduleEl.append(i),this.$container.append(this.$scheduleEl);for(var a=0;a<t.length;a++)this.updateColumnWidth(a,this.settings.columnWidth);this.settings.columnResizeEnabled&&this.configureResizing()}},{key:"populateSkedulerItems",value:function(e){var t=this,s=$(e.containerSelector),n=null,i=function d(e){if(null!=n){var s=n,i=s.$card;i.css({top:0,left:0}).removeClass("si-card-moving"),n=null,t.$ownerDocument.off("mousemove",r),t.$ownerDocument.off("mouseup",d),$(".skeduler-cell").off("mousemove",o),$(".skeduler-cell").off("mouseout",a)}},r=function(e){if(null!=n){var t=n,s=t.$card,i=t.oldX,r=t.oldY,o=i-e.clientX,a=r-e.clientY;n.offsetX-=o,n.offsetY-=a,console.log(n),s.css({top:n.offsetY+"px",left:n.offsetX+"px"}),n.oldX=e.clientX,n.oldY=e.clientY}},o=function(e){var t=$(e.currentTarget);t.css("background-color","red")},a=function(e){var t=$(e.currentTarget);t.css("background-color","white")},l=function(e){if(1===e.which){var s=$(e.currentTarget);s.addClass("si-card-moving"),n={oldX:e.clientX,oldY:e.clientY,offsetX:0,offsetY:0,$card:s},t.$ownerDocument.on("mousemove",r),t.$ownerDocument.on("mouseup",i),$(".skeduler-cell").on("mousemove",o),$(".skeduler-cell").on("mouseout",a),e.preventDefault()}};s.find(".si-card").on("mousedown",l)}},{key:"configureResizing",value:function(){var e=this,t=$("<div></div>"),s=t.clone().addClass(this.settings.resizableHandlerCssClass);this.$container.prepend(s),s.width(this.$container.width());var n=this.$scheduleEl.height()+this.$headerContainer.height(),i=0;this.$headerContainer.find("div").each(function(r,o){t.clone().addClass(e.settings.resizableSliderCssClass).css("left",o.offsetLeft+o.clientWidth).height(n).data("column-id",i++).appendTo(s)}),s.on("mousedown","."+this.settings.resizableSliderCssClass,this.onPointerDown.bind(this))}},{key:"toTimeString",value:function(e){return(e<10?"0":"")+Math.ceil(e)+(Math.ceil(e)>Math.floor(e)?":30":":00")}},{key:"getCardHeight",value:function(e){var t=60*e,s=(this.settings.lineHeight+this.settings.borderWidth)*this.settings.rowsPerHour/60;return Math.ceil(t*s)}},{key:"getCardTopPosition",value:function(e){var t=this.parseTime(e);return(this.settings.lineHeight+this.settings.borderWidth)*(t*this.settings.rowsPerHour)}},{key:"parseTime",value:function(e){return/\d{2}\:\d{2}/.test(e)?parseInt(e.split(":")[0])+parseInt(e.split(":")[1])/60:parseInt(e)}},{key:"renderInnerCardContent",value:function(e){var t=this.settings.cardTemplate;for(var s in e)e.hasOwnProperty(s)&&(t=t.replace("${"+s+"}",e[s]));return $(t)}},{key:"appendTasks",value:function(e,t){var s=this;t.forEach(function(t){var n=s.renderInnerCardContent(t),i=s.getCardTopPosition(t.startTime),r=s.getCardHeight(t.duration),o=$("<div></div>").attr({style:"top: "+i+"px; height: "+r+"px",title:s.toTimeString(t.startTime)+" - "+s.toTimeString(t.startTime+t.duration)});o.on("click",function(e){s.settings.onClick&&s.settings.onClick(e,t)}),o.append(n).appendTo(e)},this)}},{key:"appendAvailableInterval",value:function(e,t){var s=this,n=$("<div></div>");t.forEach(function(t){var i=n.clone().text("Not allocated"),r=s.getCardTopPosition(t.start)+2,o=s.parseTime(t.end)-s.parseTime(t.start),a=s.getCardHeight(o)-5,l=n.clone().attr({style:"top: "+r+"px; height: "+a+"px"});l.append(i).appendTo(e)},this)}},{key:"onPointerUp",value:function(e){this.operation;this.operation&&(this.$ownerDocument.off("mouseup"),this.$ownerDocument.off("mousemove"),this.operation=null)}},{key:"onPointerMove",value:function(e){var t=this.operation;if(this.operation){var s=e.pageX-t.startX;if(0!==s){var n=t.columnNumber,i=t.width+s;this.updateColumnWidth(n,i.toFixed(2))}}}},{key:"onPointerDown",value:function(e){if(1===e.which){this.operation&&this.onPointerUp(e);var t=$(e.currentTarget),s=t.data("column-id");console.log(this.$headerContainer);var n=t.index(),i=this.$headerContainer.find("div").eq(n),r=i[0].clientWidth;this.operation={columnNumber:s,startX:e.pageX,width:r},this.$ownerDocument.on("mousemove",this.onPointerMove.bind(this)),this.$ownerDocument.on("mouseup",this.onPointerUp.bind(this)),e.preventDefault()}}},{key:"updateColumnWidth",value:function(e,t){t=Math.max(t,this.settings.minColumnWidth),$("."+this.settings.headerContainerCssClass+" > div:eq("+e+")").css("flex-basis",t+"px");var s=$("."+this.settings.schedulerContainerCssClass+"-body > div:eq("+e+") > ."+this.settings.cellCssClass),n=s.width()-t;s.width(t),$("."+this.settings.resizableHandlerCssClass+" > div").each(function(t,s){if(t>=e){var i=$(s),r=parseInt(i.css("left").replace("px",""));i.css("left",r-n)}})}}]),e}();s["default"]=o,t.exports=s["default"]},{"./settings":3}]},{},[2]);
//# sourceMappingURL=jquery.skeduler.min.js.map
