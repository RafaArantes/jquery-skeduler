/**
 * jquery-skeduler - This is jQuery plugin which provider you simple scheduler with some items on OX and 24-hours timeline on OY.
 * @date Sun Aug 27 2017 15:52:44 GMT+1000 (+10)
 * @version v0.2.0-beta.0
 * @link 
 * @license ISC
 */
!function e(t,s,i){function n(r,o){if(!s[r]){if(!t[r]){var l="function"==typeof require&&require;if(!o&&l)return l(r,!0);if(a)return a(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var u=s[r]={exports:{}};t[r][0].call(u.exports,function(e){var s=t[r][1][e];return n(s?s:e)},u,u.exports,e,t,s,i)}return s[r].exports}for(var a="function"==typeof require&&require,r=0;r<i.length;r++)n(i[r]);return n}({1:[function(e,t,s){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var n=e("./skeduler"),a=i(n);$.fn.skeduler=function(e){var t=$(this),s=new a["default"](t,e);return s},$.skeduler=a["default"]},{"./skeduler":5}],2:[function(e,t,s){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(s,"__esModule",{value:!0});var n=e("./skeduler"),a=i(n),r=e("./adapter");i(r);s["default"]=a["default"],t.exports=s["default"]},{"./adapter":1,"./skeduler":5}],3:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=e("../template"),n=e("../utils"),a=function(e){return $("<div></div>").addClass(e)},r=function(e){var t=a(e.itemsOptions.itemCardCssClass),s=e.items,n=(0,i.compileTemplate)(e.itemsOptions.itemCardTemplate,{time:function(e){return e.interval?e.interval.start+" to "+e.interval.end:""}});return s.map(function(e){return t.clone().data("index",e.index).html(n(e))})},o=function(e,t,s){e=Math.max(0,e);var i=e/t;return(0,n.toTime)(i+(0,n.parseTime)(s.start))},l=function(e){var t=function(t,s){return s?e.tasks.filter(function(e){return e.item.index===t})[0].item:e.items.filter(function(e){return e.index===t})[0]},s=$(e.itemsOptions.containerSelector).empty().addClass(e.itemsOptions.itemsCssClass),i=$(s[0].ownerDocument),l=$("."+e.availableIntervalPlaceholderCssClass+" > div"),d=(a().html('<h1 class="si-header">'+e.itemsOptions.title+"</h1>").appendTo(s),a("si-container")),u=r(e);u.forEach(function(e){d.append(e)}),d.appendTo(s);var h=null,c=null,m=function g(s){if(null!=h){var a=h,r=a.$movingCard,o=a.$card,l=a.startTime,u=$("."+e.itemsOptions.highlightItemCss+":visible"),m=parseInt(r.data("index")),C=!!r.data("assigned"),v=t(m,C);if(c&&(c.removeClass("conflicted"),c=null),1==d.data("selected"))C&&(e.tasks=e.tasks.filter(function(e){return e.item.index!=m}),e.items.push(v),e.itemsOptions.onItemWillBeUnassigned&&e.itemsOptions.onItemWillBeUnassigned({item:v})),r.detach().css({top:"auto",left:"auto"}).height("auto").width("auto").data("assigned",0).removeClass(e.itemsOptions.itemCardCssClass+"-moving").removeClass(e.itemsOptions.itemCardCssClass+"-pinned").appendTo(d),r.on("mousedown",f),o.remove(),C&&e.itemsOptions.onItemDidUnassigned&&e.itemsOptions.onItemDidUnassigned({item:v});else if(0!==u.length&&1==u.data("match")){var k=(e.lineHeight+1,parseInt(u.parent().data("column"))),b=60*(0,n.parseTime)(l),x=e.data[k].availableIntervals[u.parent().data("item-index")];if(e.itemsOptions.onItemWillBeAssigned&&e.itemsOptions.onItemWillBeAssigned({item:v,interval:x,offsetInMinutes:b}),r.detach().css({top:u[0].offsetTop,left:0}).height(u[0].clientHeight).width("auto").data("assigned",1).removeClass(e.itemsOptions.itemCardCssClass+"-moving").addClass(e.itemsOptions.itemCardCssClass+"-pinned").appendTo(u.parent()),r.on("mousedown",f),o.remove(),C){var w=e.tasks.find(function(e){return e.item.index===m});w.start=l,w.column=k}else e.tasks.push({column:k,start:l,item:v});e.itemsOptions.onItemDidAssigned&&e.itemsOptions.onItemDidAssigned({item:v,interval:x,offsetInMinutes:b})}else r.remove(),o.show();$("."+e.itemsOptions.highlightItemCss).hide(),d.removeClass("highlighted"),d.data("selected",0),h=null,i.off("mousemove",p),i.off("mouseup",g)}},p=function(s){if(null!=h){var a=h,r=a.$movingCard,u=a.offsetX,m=a.offsetY,p=s.pageX-u,f=s.pageY-m;r.css({top:f+"px",left:p+"px"});var g=i[0].defaultView,C=s.pageX,v=s.pageY-g.scrollY,k=e.lineHeight+1,b=e.rowsPerHour,x=parseInt(r.data("index")),w=!!r.data("assigned"),O=t(x,w),T=O.duration,I=T*(k*b/60);c&&(c.removeClass("conflicted"),c=null),d.each(function(){var e=$(this),t=this.getBoundingClientRect();C>t.left&&C<t.right&&v>t.top&&v<t.bottom?(e.addClass("highlighted"),d.data("selected",1)):(e.removeClass("highlighted"),d.data("selected",0))}),l.each(function(){var t=this,s=$(this),i=this.getBoundingClientRect(),a=s.find("."+e.itemsOptions.highlightItemCss);C>i.left&&C<i.right&&v>i.top&&v<i.bottom?!function(){var r=v-i.top,l=Math.floor(r/k)-1,d=Math.min(Math.max(0,l*k),t.clientHeight-I),u=+s.data("column"),m=+s.data("item-index"),p=60/e.rowsPerHour*(d/k),f=e.data[u].availableIntervals[m],g=e.itemsOptions.matchFunc(O,f,p);h.startTime=o(l,b,f),a.css({top:d}).css("background-color",g.color).height(I).show(),a.data("match",+g.match),g.match&&e.tasks.filter(function(e){return e.column==u&&e.item.index!=x}).forEach(function(e){var t=(0,n.parseTime)(e.start),i=(0,n.parseTime)(h.startTime);t>=i+O.duration/60||t+e.item.duration/60<=i||(console.log(e.item.name),s.find(".si-card").each(function(){$(this).data("index")==e.item.index&&(c=$(this),c.addClass("conflicted"))}))})}():(a.data("match",0),a.hide())})}},f=function(s){if(1===s.which){var n=$("."+e.skedulerWrapperCssClass),a=$(s.currentTarget),r=a.clone().data("index",a.data("index")).data("assigned",a.data("assigned")).addClass(e.itemsOptions.itemCardCssClass+"-moving").removeClass(e.itemsOptions.itemCardCssClass+"-pinned").width(a.width()).appendTo(n),o=s.pageX-s.offsetX,l=s.pageY-s.offsetY;r.css({top:l+"px",left:o+"px"}),h={$card:a,$movingCard:r,offsetX:s.offsetX,offsetY:s.offsetY};var d=parseInt(a.data("index")),u=!!r.data("assigned");t(d,u);a.hide(),i.on("mousemove",p),i.on("mouseup",m),s.preventDefault()}};$("."+e.itemsOptions.itemCardCssClass).on("mousedown",f)};s["default"]=l,t.exports=s["default"]},{"../template":6,"../utils":7}],4:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=arguments,n={headers:null,tasks:[],items:[],notAllocatedLabel:"Not allocated",cardTemplate:"<div>${id}</div>",skedulerWrapperCssClass:"skeduler-wrapper",containerCssClass:"skeduler-container",headerContainerCssClass:"skeduler-headers",schedulerContainerCssClass:"skeduler-main",taskPlaceholderCssClass:"skeduler-task-placeholder",availableIntervalPlaceholderCssClass:"skeduler-interval-placeholder",cellCssClass:"skeduler-cell",resizableHandlerCssClass:"resizable-handler",resizableSliderCssClass:"resizable-slider",lineHeight:30,borderWidth:1,columnWidth:200,minColumnWidth:100,rowsPerHour:2,columnResizeEnabled:!0,debug:!1,itemsOptions:{enabled:!1,itemsCssClass:"skeduler-items",highlightItemCss:"si-highlight-item",containerSelector:"#skeduler-items",itemCardCssClass:"si-card",itemCardTemplate:"<div>${duration}</div>",title:"Items",onItemWillBeAssigned:function(){console.log(i)},onItemDidAssigned:function(){console.log(i)},onItemWillBeUnassigned:function(){console.log(i)},onItemDidUnassigned:function(){console.log(i)},matchFunc:function(){return{match:!0}}}};s.defaultSettings=n},{}],5:[function(e,t,s){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(s,"__esModule",{value:!0});var a=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}(),r=e("./settings"),o=e("./items"),l=i(o),d=e("./template"),u=e("./utils"),h=function(e){return $("<div></div>").addClass(e)},c=function(){function e(t,s){n(this,e),this.settings=$.extend(!0,r.defaultSettings,s),this.$container=t,this.$ownerDocument=$(t[0].ownerDocument),this.$headerContainer=null,this.$scheduleEl=null,this.operation=null,this.resizeAllColumns=!0,this.settings.debug&&console.time("skeduler"),this.refresh(),this.settings.debug&&console.timeEnd("skeduler")}return a(e,[{key:"setRowsPerHour",value:function(e){this.settings.rowsPerHour=e,this.refresh()}},{key:"setResizeAllColumns",value:function(e){this.resizeAllColumns=e}},{key:"refresh",value:function(){var e=this;this.settings.items=this.settings.items&&this.settings.items.map(function(e,t){return Object.assign({},{index:t},e)})||[],this.settings.tasks=this.settings.tasks&&this.settings.tasks.map(function(t,s){return t.item=Object.assign({},{index:s+e.settings.items.length},t.item),t})||[],this.populate(),this.settings.itemsOptions.enabled&&(0,l["default"])(this.settings)}},{key:"populate",value:function(){var e=this;this.$container.empty(),this.$container.addClass(this.settings.containerCssClass);var t=this.settings.headers?this.settings.headers:this.settings.data.map(this.settings.getHeader);this.$headerContainer=h(this.settings.headerContainerCssClass),t.forEach(function(t){h().text(t).appendTo(e.$headerContainer)},this),this.$container.append(this.$headerContainer),this.$scheduleEl=h(this.settings.schedulerContainerCssClass);for(var s=h(this.settings.schedulerContainerCssClass+"-timeline"),i=h(this.settings.schedulerContainerCssClass+"-body"),n=h(),a=0;a<24;a++)for(var r=0;r<this.settings.rowsPerHour;r++){var o=h().height(this.settings.lineHeight).addClass(r==this.settings.rowsPerHour-1?"last":"");0==r&&(o=o.css("line-height",this.settings.lineHeight+"px").text(0==r?this.toTimeString(a):"")),o.appendTo(s),h(this.settings.cellCssClass).height(this.settings.lineHeight).addClass(r==this.settings.rowsPerHour-1?"last":"").appendTo(n)}for(var r=0;r<t.length;r++){var l=n.clone(),d=h(this.settings.availableIntervalPlaceholderCssClass),u=this.settings.data[r].availableIntervals;this.appendAvailableInterval(d,u,r),l.prepend(d),l.appendTo(i),this.updateColumnWidth(r,this.settings.columnWidth)}this.$scheduleEl.append(s),this.$scheduleEl.append(i),this.$container.append(this.$scheduleEl);for(var r=0;r<t.length;r++)this.updateColumnWidth(r,this.settings.columnWidth);this.settings.columnResizeEnabled&&this.configureResizing()}},{key:"tasks",value:function(){return this.settings.tasks}},{key:"configureResizing",value:function(){var e=this,t=h(this.settings.resizableHandlerCssClass);this.$container.prepend(t),t.width(this.$container.width());var s=this.$scheduleEl.height()+this.$headerContainer.height(),i=0;this.$headerContainer.find("div").each(function(n,a){h(e.settings.resizableSliderCssClass).css("left",a.offsetLeft+a.clientWidth).height(s).data("column-id",i++).appendTo(t)}),t.on("mousedown","."+this.settings.resizableSliderCssClass,this.onResizePointerDown.bind(this))}},{key:"appendAvailableInterval",value:function(e,t,s){var i=this;t.forEach(function(t,n){var a=h().text(i.settings.notAllocatedLabel),r=i.getCardTopPosition(t.start)+2,o=(0,u.parseTime)(t.end)-(0,u.parseTime)(t.start),l=i.getCardHeight(o)-5,d=h(i.settings.itemsOptions.highlightItemCss).hide(),c=h().attr({style:"top: "+r+"px; height: "+l+"px"});c.data("column",s).data("item-index",n).append(a).append(d).appendTo(e),i.appendTasks(c,t.start,i.settings.tasks.filter(function(e){return e.column==s}))},this)}},{key:"appendTasks",value:function(e,t,s){var i=this;s.forEach(function(s){var n=i.getCardTopPosition(s.start,t),a=i.getCardHeight(s.item.duration/60);i.getItemDiv(s.item).attr({style:"top: "+n+"px; height: "+a+"px"}).addClass(""+i.settings.itemsOptions.itemCardCssClass).addClass(i.settings.itemsOptions.itemCardCssClass+"-pinned").width("auto").data("index",s.item.index).data("assigned",1).appendTo(e)},this)}},{key:"onResizePointerUp",value:function(e){this.operation;this.operation&&(this.$ownerDocument.off("mouseup"),this.$ownerDocument.off("mousemove"),this.operation=null)}},{key:"onResizePointerMove",value:function(e){var t=this.operation;if(this.operation){var s=e.pageX-t.startX;if(0!==s){var i=t.columnNumber,n=t.width+s;if(this.resizeAllColumns)for(var a=0;a<this.settings.data.length;a++)this.updateColumnWidth(a,n.toFixed(2));else this.updateColumnWidth(i,n.toFixed(2))}}}},{key:"onResizePointerDown",value:function(e){if(1===e.which){this.operation&&this.Resize(e);var t=$(e.currentTarget),s=t.data("column-id"),i=t.index(),n=this.$headerContainer.find("div").eq(i),a=n[0].clientWidth;this.operation={columnNumber:s,startX:e.pageX,width:a},this.$ownerDocument.on("mousemove",this.onResizePointerMove.bind(this)),this.$ownerDocument.on("mouseup",this.Resize.bind(this)),e.preventDefault()}}},{key:"updateColumnWidth",value:function(e,t){t=Math.max(t,this.settings.minColumnWidth),$("."+this.settings.headerContainerCssClass+" > div:eq("+e+")").css("flex-basis",t+"px");var s=$("."+this.settings.schedulerContainerCssClass+"-body > div:eq("+e+") > ."+this.settings.cellCssClass),i=s.width()-t;s.width(t),$("."+this.settings.resizableHandlerCssClass+" > div").each(function(t,s){if(t>=e){var n=$(s),a=parseInt(n.css("left").replace("px",""));n.css("left",a-i)}})}},{key:"getItemDiv",value:function(e){var t=(h(this.settings.itemsOptions.itemCardCssClass),(0,d.compileTemplate)(this.settings.itemsOptions.itemCardTemplate,{time:function(e){return e.interval?e.interval.start+" to "+e.interval.end:""}}));return h().html(t(e))}},{key:"toTimeString",value:function(e){return(e<10?"0":"")+Math.floor(e)+(Math.ceil(e)>Math.floor(e)?":30":":00")}},{key:"getCardHeight",value:function(e){var t=60*e,s=(this.settings.lineHeight+this.settings.borderWidth)*this.settings.rowsPerHour/60;return Math.ceil(t*s)}},{key:"getCardTopPosition",value:function(e,t){var s=(0,u.parseTime)(e);return t&&(s-=(0,u.parseTime)(t)),(this.settings.lineHeight+this.settings.borderWidth)*(s*this.settings.rowsPerHour)}}]),e}();s["default"]=c,t.exports=s["default"]},{"./items":3,"./settings":4,"./template":6,"./utils":7}],6:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=function(e,t){return function(s){for(var i=e,n=/\$\{(\w+)\}/g,a=/\$\{(\w+)\(\)\}/g,r=1;;){if(r=n.exec(e),!r)break;var o=r[1];s.hasOwnProperty(o)&&(i=i.replace(r[0],s[o]))}for(;t&&(r=a.exec(e));){var o=r[1];t.hasOwnProperty(o)&&(i=i.replace(r[0],t[o](s)))}return i}};s["default"]={compileTemplate:i},t.exports=s["default"]},{}],7:[function(e,t,s){"use strict";function i(e){return/\d{1,2}\:\d{2}/.test(e)?parseInt(e.split(":")[0])+parseInt(e.split(":")[1])/60:parseInt(e)}function n(e){return(e<10?"0":"")+Math.floor(e)+(Math.ceil(e)>Math.floor(e)?":30":":00")}Object.defineProperty(s,"__esModule",{value:!0}),s.parseTime=i,s.toTime=n},{}]},{},[2]);
//# sourceMappingURL=jquery.skeduler.min.js.map
